version: '3.8'

services:
    matrix:
        image: equalifyapp/a11ymatrix:latest
        environment:
            - APP_PORT=8087
            - http_proxy
            - https_proxy
            - FRANKLIN_URL
        ports:
          - "8500:80"
          - "8081:8080"
          - "8087:8087"
        networks:
            - gova11y-net
            - gova11y-ext

    scan-axe:
        image: equalifyapp/integration-axe:latest
        environment:
            - APP_PORT=8083
            - RABBIT_USERNAME
            - RABBIT_PASSWORD
            - RABBIT_HOST
            - RABBIT_VHOST
            - USE_PROXY
            - PROXY_HTTP
            - PROXY_HTTPS
        networks:
            - gova11y-net
        healthcheck:
            test: ["CMD", "curl", "-f", "http://localhost:8083/health"]
            interval: 5m
            timeout: 3s
        deploy:
            replicas: 5



networks:
    gova11y-int:
    gova11y-ext:
